import telebot
from menu import Menu
from telebot import types

bot = telebot.TeleBot('5278792568:AAFt3lJxrghz3F7WiMCKXxsQsfOQ3FC0Lqo')

@bot.message_handler(commands="start")
def command(message,res=False):
    txt_message = f"Привет, {message.from_user.first_name}! Я тестовый бот для курса программирования на языке Python"
    bot.send_message(message.chat.id, text=txt_message, reply_markup=Menu.getMenu("Главное меню").)

def send_help(chat_id):
    global bot
    bot.send_message(chat_id, "Автор: Копина Саша")
    markup = types.InlineKeyboardMarkup()
    btn1 = types.InlineKeyboardMarkButton(text="Напишите автору", url="https://t.me/kopinaS")
    markup.add(btn1)
    
@bot.message_handler(fune=lambda message: True)
def get_text_message(message):
    chat_id = message.chat.id
    ms_text = message.text
    
    if Men.cur_menu != None and ms_text in Menu.cur_menu.buttons:
        if ms_text == "Помощь":
            send_help(chat_id)
            
def goto_menu(chat_id, name_menu):
    if name_menu == "Выход" and Menu.cur_menu != None and Menu.cur_menu.parent != None:
        target_menu = Menu.getMenu(Menu.cur_menu.parent.name)
    else:
        target_menu = Menu.getMenu(name_menu)
        
    if target_menu != None:
        bot.send_message(chat_id, text=target_menu.name, reply_markup=target_menu.markup)
        
bot.infinity_polling()


#------------------

m_main = Menu("Главное меню", buttons=["Развлечения", "Игры", "Помощь"])

m_games = Menu("Игры", buttons=["Города", "Выход"], parent=m_main)
m_game_cities = Menu("Города", buttons=["Город", "Выход"], parent=m_games, action="game_cities")
m_fun = Menu("Развлечения", buttons=["Прогулки", "Кафе/рестораны", "Выход"], parent=m_main)
